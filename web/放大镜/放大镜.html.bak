<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>Document</title>
	<style>
		*{
			margin:0px;
			padding:0px;
		}
		#small{
			width:300px;
			height:300px;
			border:1px solid #f0f;
			position:absolute;
			top:10px;
			left:10px;
		}
		#small img{
			width:100%;
			height:100%;
		}
		#big{
			width:500px;
			height:500px;
			border:1px solid #ccc;
			position:absolute;
			top:10px;
			left:350px;
			display:none;
			overflow:hidden;
		}
		#big img{
			position:absolute;
			top:0px;
			left:0px;
		}
		#small span{
			width:160px;
			height:160px;
			background:yellow;
			opacity:0.3;
			position:absolute;
			top:0px;
			left:0px;
			display:none;
		}
	</style>
 </head>
	<script>
		window.onload = function(){
			var oSmall = document.getElementById('small');
			var oSpan = oSmall.getElementsByTagName('span')[0];
			var oBig = document.getElementById('big');
			var oImg = oBig.getElementsByTagName('img')[0];
			//移入
			oSmall.onmouseenter = function(){
				oSpan.style.display = 'block';
				oBig.style.display = 'block';
			}
			//移动
				oSmall.onmousemove = function(ev){
					var oEvent = ev || event;
					var l = oEvent.clientX -oSpan.offsetWidth/2- oSmall.offsetLeft;
					var t = oEvent.clientY - oSpan.offsetHeight/2- oSmall.offsetTop;
					if(l <= 0){
						l = 0;
					}
					if(l >= oSmall.offsetWidth - oSpan.offsetWidth ){
						l = oSmall.offsetWidth - oSpan.offsetWidth;
					}
					if(t <= 0){
						t = 0;
					}
					if(t >= oSmall.offsetHeight - oSpan.offsetHeight){
						t = oSmall.offsetHieght - oSpan.offsetHeight;
					}
					oSpan.style.left = l +'px';
					oSpan.style.top = t +'px';
					oImg.style.left = -l*(oImg.offsetWidth - oBig.offsetWidth)/(oSmall.offsetWidth - oSpan.offsetWidth)+'px';
					oImg.style.top = -t*(oImg.offsetHeight - oBig.offsetHeight)/(oSmall.offsetHeight - oSpan.offsetHeight)+'px';
				document.onmouseup = function(){
					document.onmousemove = null;
					document.onmouseup = null;
				}
				return false;
			}
			//移出
			oSmall.onmouselevae = function(){
				oSpan.style.display = 'none';
				oBig.style.display = 'none';
			}
		}
	</script>
 <body>
	<div id="box">
		<div id="small">
			<img src="b1.jpg"/>
			<span></span>
		</div>
		<div id="big">
			<img src="b1.jpg"/>
		</div>
	</div>
 </body>
</html>
